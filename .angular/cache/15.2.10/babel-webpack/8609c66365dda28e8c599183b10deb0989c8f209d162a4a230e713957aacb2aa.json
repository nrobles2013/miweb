{"ast":null,"code":"import HighlightJS from \"highlight.js\";\nimport { Subject } from \"rxjs\";\nimport { takeUntil } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let EgretHighlightDirective = /*#__PURE__*/(() => {\n  class EgretHighlightDirective {\n    constructor(el, cdr, _zone, http) {\n      this.el = el;\n      this.cdr = cdr;\n      this._zone = _zone;\n      this.http = http;\n      // Inner highlighted html\n      this.highlightedCode = '';\n      this.path = '';\n      this.code = '';\n      this.languages = [];\n      this.unsubscribeAll = new Subject();\n    }\n    ngOnInit() {\n      if (this.code) {\n        this.highlightElement(this.code);\n      }\n      if (this.path) {\n        this.highlightedCode = \"Loading...\";\n        this.http.get(this.path, {\n          responseType: \"text\"\n        }).pipe(takeUntil(this.unsubscribeAll)).subscribe(response => {\n          this.highlightElement(response, this.languages);\n        });\n      }\n    }\n    ngOnDestroy() {\n      this.unsubscribeAll.next(1);\n      this.unsubscribeAll.complete();\n    }\n    ngOnChanges(changes) {\n      if (changes[\"code\"] && changes[\"code\"].currentValue && changes[\"code\"].currentValue !== changes[\"code\"].previousValue) {\n        this.highlightElement(this.code);\n        // console.log('hljs on change', changes)\n      }\n    }\n\n    highlightElement(code, languages) {\n      this._zone.runOutsideAngular(() => {\n        const res = HighlightJS.highlightAuto(code);\n        this.highlightedCode = res.value;\n        // this.cdr.detectChanges();\n        // console.log(languages)\n      });\n    }\n  }\n\n  EgretHighlightDirective.ɵfac = function EgretHighlightDirective_Factory(t) {\n    return new (t || EgretHighlightDirective)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(i1.HttpClient));\n  };\n  EgretHighlightDirective.ɵdir = /*@__PURE__*/i0.ɵɵdefineDirective({\n    type: EgretHighlightDirective,\n    selectors: [[\"\", \"egretHighlight\", \"\"]],\n    hostVars: 3,\n    hostBindings: function EgretHighlightDirective_HostBindings(rf, ctx) {\n      if (rf & 2) {\n        i0.ɵɵhostProperty(\"innerHTML\", ctx.highlightedCode, i0.ɵɵsanitizeHtml);\n        i0.ɵɵclassProp(\"hljs\", true);\n      }\n    },\n    inputs: {\n      path: \"path\",\n      code: [\"egretHighlight\", \"code\"],\n      languages: \"languages\"\n    },\n    features: [i0.ɵɵNgOnChangesFeature]\n  });\n  return EgretHighlightDirective;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}