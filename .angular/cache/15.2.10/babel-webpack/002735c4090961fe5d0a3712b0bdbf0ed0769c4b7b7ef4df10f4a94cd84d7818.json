{"ast":null,"code":"import { inject } from '@angular/core';\nimport { UntypedFormGroup, UntypedFormControl, Validators } from '@angular/forms';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MaterialModule } from 'app/app/mimodule/material.module';\nimport { Auditoria } from 'app/shared/models/auditoria.model';\nimport { UtilService } from 'app/shared/services/util.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"app/services/reportes/riesgos.service\";\nimport * as i2 from \"@angular/material/snack-bar\";\nimport * as i3 from \"app/shared/services/reportes.service\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"app/shared/services/auth/jwt-auth.service\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"app/shared/services/auditoria.service\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"@angular/material/input\";\nimport * as i10 from \"@angular/material/form-field\";\nimport * as i11 from \"@angular/material/select\";\nimport * as i12 from \"@angular/material/core\";\nimport * as i13 from \"@angular/material/button\";\nimport * as i14 from \"@angular/flex-layout/flex\";\nimport * as i15 from \"@angular/flex-layout/extended\";\nfunction ConsultasComponent_mat_option_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const p_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", p_r8.codigo);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", p_r8.descripcion, \" \");\n  }\n}\nfunction ConsultasComponent_mat_option_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const r_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", r_r9.anio);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", r_r9.anio, \" \");\n  }\n}\nfunction ConsultasComponent_mat_option_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const p_r10 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", p_r10.nperiodo);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", p_r10.descripcion, \" \");\n  }\n}\nfunction ConsultasComponent_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\");\n  }\n}\nfunction ConsultasComponent_ng_template_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵelement(1, \"div\", 19);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ConsultasComponent_ng_template_32_Template(rf, ctx) {}\nconst _c0 = function (a0) {\n  return {\n    \"color\": a0\n  };\n};\nexport let ConsultasComponent = /*#__PURE__*/(() => {\n  class ConsultasComponent {\n    constructor(riesgoService, _snackBar, reportesService, fb, jwtAuth, router, route, auditoriaService) {\n      this.riesgoService = riesgoService;\n      this._snackBar = _snackBar;\n      this.reportesService = reportesService;\n      this.fb = fb;\n      this.jwtAuth = jwtAuth;\n      this.router = router;\n      this.route = route;\n      this.auditoriaService = auditoriaService;\n      this.utilService = inject(UtilService);\n      this.isLoading = this.utilService.isLoading; // Variable para controlar la visibilidad del spinner\n      this.getListAnio = [];\n      this.getListDocumentos = [];\n      this.getListPeriodo = [];\n      this.totalElements = 0;\n    }\n    ngAfterViewInit() {\n      if (this.jwtAuth.user.cparticipe == \"99999\") {\n        this.router.navigate(['/sessions/signin']);\n      }\n      // Event listener para 'touchmove' con passive: true\n      window.addEventListener('touchmove', this.handleTouchMove, {\n        passive: true\n      });\n      // Event listener para 'touchstart' con passive: true\n      window.addEventListener('touchstart', this.handleTouchStart, {\n        passive: true\n      });\n    }\n    ngOnInit() {\n      this.consultaForm = new UntypedFormGroup({\n        documentos: new UntypedFormControl(this.iddocumentoSelected, Validators.required),\n        anio: new UntypedFormControl(this.idAnioSelected, Validators.required),\n        periodo: new UntypedFormControl(this.idPeriodoSelected)\n      });\n      this.reportesService.getListAnioConsulta().subscribe(response => {\n        this.getListAnio = response;\n      });\n      this.reportesService.getListDocumentosConsulta(\"0001\").subscribe(response => {\n        this.getListDocumentos = response;\n      });\n      this.reportesService.getListPeriodoConsulta().subscribe(response => {\n        this.getListPeriodo = response;\n      });\n      this.reportesService.getListFileRutaConsulta(\"0001\").subscribe(response => {\n        this.getListFileRuta = response;\n        console.log(response);\n        let datosparse = JSON.stringify(response);\n        let info = JSON.parse(datosparse);\n        console.log(info);\n        this.getcontenido = info.contenido;\n        this.getrespuesta = info.respuesta;\n        this.getruta = info.ruta;\n      });\n    }\n    buscardocumentos() {\n      this.consultaForm = new UntypedFormGroup({\n        documentos: new UntypedFormControl(this.iddocumentoSelected, Validators.required),\n        anio: new UntypedFormControl(this.idAnioSelected, Validators.required),\n        periodo: new UntypedFormControl(this.idPeriodoSelected)\n      });\n      if (this.consultaForm.invalid) {\n        this._snackBar.open(\"Ingresar datos requeridos\", 'Verificar', {\n          duration: 1000,\n          horizontalPosition: 'right',\n          verticalPosition: 'top'\n        });\n        return;\n      }\n      this.jwtAuth.traerIP().subscribe(data => {\n        let date = new Date();\n        let ip = JSON.stringify(data.ip);\n        this.miip = ip;\n        this.auditoria = new Auditoria(this.miip, this.jwtAuth.user.usuario_id, this.jwtAuth.user.username, \"Consulta documentos\", this.jwtAuth.user.idtipoparticipe, this.jwtAuth.user.cparticipe, date);\n        this.auditoriaService.insertar(this.auditoria).subscribe();\n      });\n      let carpeta = \"\";\n      let rutafinal = \"\";\n      if (this.iddocumentoSelected == \"0001\") {\n        carpeta = \"estadocuenta\";\n        rutafinal = this.getruta + \"\\\\\" + carpeta + \"\\\\\" + this.idAnioSelected + \"\\\\\" + this.idPeriodoSelected;\n      }\n      if (this.iddocumentoSelected == \"0002\") {\n        carpeta = \"liquidacion\";\n        rutafinal = this.getruta + \"\\\\\" + carpeta + \"\\\\\" + this.idAnioSelected + \"\\\\\" + this.idPeriodoSelected;\n      }\n      if (this.iddocumentoSelected == \"0008\") {\n        carpeta = \"atribucion\";\n        rutafinal = this.getruta + \"\\\\\" + carpeta + \"\\\\\" + this.idAnioSelected;\n      }\n      if (this.iddocumentoSelected == \"0009\") {\n        carpeta = \"retencion\";\n        rutafinal = this.getruta + \"\\\\\" + carpeta + \"\\\\\" + this.idAnioSelected;\n      }\n      this.reportesService.getFileRutaEnvioConsulta(rutafinal, this.jwtAuth.user.cparticipe, this.iddocumentoSelected, this.jwtAuth.user.correo, this.idAnioSelected, this.idPeriodoSelected).subscribe(response => {\n        let datosparse = JSON.stringify(response);\n        let mensaje = JSON.parse(datosparse);\n        if (mensaje.mensaje == \"se envio el correo, Correctamente\") {\n          this.getflag = true;\n          this.getcontenido = this.getrespuesta;\n        }\n        this._snackBar.open(mensaje.mensaje, 'Informe', {\n          duration: 2000,\n          horizontalPosition: 'right',\n          verticalPosition: 'top'\n        });\n      }, err => {\n        this.router.navigate(['/sessions/signin']);\n      });\n    }\n    listPageable(p, s) {\n      // return this.http.get<any>(`${this.url}/pageable?page=${p}&size=${s}`);\n    }\n    ejecutoAnio(event) {\n      this.idAnioSelected = event.value;\n    }\n    ejecutoPeriodo(event) {\n      if (this.iddocumentoSelected != \"0008\") {\n        this.idPeriodoSelected = event.value;\n      }\n      if (this.iddocumentoSelected != \"0009\") {\n        this.idPeriodoSelected = event.value;\n      }\n    }\n    ejecutoDocumentos(event) {\n      this.iddocumentoSelected = event.value;\n    }\n    handleTouchMove(event) {\n      // Lógica para manejar el evento 'touchmove'\n      // Puedes agregar aquí cualquier código que necesites ejecutar cuando se detecte el evento 'touchmove'\n    }\n    handleTouchStart(event) {\n      // Lógica para manejar el evento 'touchstart'\n      // Puedes agregar aquí cualquier código que necesites ejecutar cuando se detecte el evento 'touchstart'\n    }\n  }\n  ConsultasComponent.ɵfac = function ConsultasComponent_Factory(t) {\n    return new (t || ConsultasComponent)(i0.ɵɵdirectiveInject(i1.RiesgosService), i0.ɵɵdirectiveInject(i2.MatSnackBar), i0.ɵɵdirectiveInject(i3.ReportesService), i0.ɵɵdirectiveInject(i4.UntypedFormBuilder), i0.ɵɵdirectiveInject(i5.JwtAuthService), i0.ɵɵdirectiveInject(i6.Router), i0.ɵɵdirectiveInject(i6.ActivatedRoute), i0.ɵɵdirectiveInject(i7.AuditoriaService));\n  };\n  ConsultasComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ConsultasComponent,\n    selectors: [[\"app-documentos\"]],\n    viewQuery: function ConsultasComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(MatPaginator, 5);\n        i0.ɵɵviewQuery(MaterialModule, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.materialModule = _t.first);\n      }\n    },\n    decls: 34,\n    vars: 17,\n    consts: [[\"fxLayout\", \"column\", 1, \"signup-form\", 3, \"formGroup\", \"ngSubmit\"], [1, \"body-container\"], [1, \"mat-elevation-10\"], [1, \"example-container\"], [\"appearance\", \"outline\", 1, \"example-container3\"], [\"placeholder\", \"Seleccione Documentos\", \"formControlName\", \"iddocumentoSelected\", 3, \"ngModel\", \"selectionChange\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"example-spacer\"], [\"placeholder\", \"Seleccione A\\u00F1o\", \"formControlName\", \"idAnioSelected\", 3, \"ngModel\", \"selectionChange\", \"ngModelChange\"], [\"placeholder\", \"Seleccione Periodo\", \"formControlName\", \"idPeriodoSelected\", 3, \"ngModel\", \"selectionChange\", \"ngModelChange\"], [\"mat-raised-button\", \"\", 2, \"width\", \"10px\"], [\"src\", \"assets/images/lupa.jpg\", \"alt\", \"MDN\", 1, \"imagenlupa\"], [1, \"example-container\", 2, \"border\", \"1px\"], [\"rows\", \"10\", \"cols\", \"40\", \"matInput\", \"\", 1, \"example-full-width\", 2, \"border\", \"1px\", 3, \"ngClass\", \"disabled\"], [4, \"ngIf\", \"ngIfThen\", \"ngIfElse\"], [\"loading\", \"\"], [\"content\", \"\"], [3, \"value\"], [1, \"overlay\"], [1, \"spinner\"]],\n    template: function ConsultasComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function ConsultasComponent_Template_form_ngSubmit_0_listener() {\n          return ctx.buscardocumentos();\n        });\n        i0.ɵɵelementStart(1, \"body\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"mat-form-field\", 4)(5, \"mat-label\");\n        i0.ɵɵtext(6, \"Documentos\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"mat-select\", 5);\n        i0.ɵɵlistener(\"selectionChange\", function ConsultasComponent_Template_mat_select_selectionChange_7_listener($event) {\n          return ctx.ejecutoDocumentos($event);\n        })(\"ngModelChange\", function ConsultasComponent_Template_mat_select_ngModelChange_7_listener($event) {\n          return ctx.iddocumentoSelected = $event;\n        });\n        i0.ɵɵtemplate(8, ConsultasComponent_mat_option_8_Template, 2, 2, \"mat-option\", 6);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(9, \"span\", 7);\n        i0.ɵɵelementStart(10, \"mat-form-field\", 4)(11, \"mat-label\");\n        i0.ɵɵtext(12, \"A\\u00F1o\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"mat-select\", 8);\n        i0.ɵɵlistener(\"selectionChange\", function ConsultasComponent_Template_mat_select_selectionChange_13_listener($event) {\n          return ctx.ejecutoAnio($event);\n        })(\"ngModelChange\", function ConsultasComponent_Template_mat_select_ngModelChange_13_listener($event) {\n          return ctx.idAnioSelected = $event;\n        });\n        i0.ɵɵtemplate(14, ConsultasComponent_mat_option_14_Template, 2, 2, \"mat-option\", 6);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(15, \"span\", 7);\n        i0.ɵɵelementStart(16, \"mat-form-field\", 4)(17, \"mat-label\");\n        i0.ɵɵtext(18, \"Periodo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"mat-select\", 9);\n        i0.ɵɵlistener(\"selectionChange\", function ConsultasComponent_Template_mat_select_selectionChange_19_listener($event) {\n          return ctx.ejecutoPeriodo($event);\n        })(\"ngModelChange\", function ConsultasComponent_Template_mat_select_ngModelChange_19_listener($event) {\n          return ctx.idPeriodoSelected = $event;\n        });\n        i0.ɵɵtemplate(20, ConsultasComponent_mat_option_20_Template, 2, 2, \"mat-option\", 6);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(21, \"span\", 7);\n        i0.ɵɵelementStart(22, \"button\", 10);\n        i0.ɵɵelement(23, \"img\", 11);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(24, \"hr\");\n        i0.ɵɵelementStart(25, \"div\", 12)(26, \"textarea\", 13);\n        i0.ɵɵtext(27);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵtemplate(28, ConsultasComponent_div_28_Template, 1, 0, \"div\", 14);\n        i0.ɵɵpipe(29, \"async\");\n        i0.ɵɵtemplate(30, ConsultasComponent_ng_template_30_Template, 2, 0, \"ng-template\", null, 15, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(32, ConsultasComponent_ng_template_32_Template, 0, 0, \"ng-template\", null, 16, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        const _r4 = i0.ɵɵreference(31);\n        const _r6 = i0.ɵɵreference(33);\n        i0.ɵɵproperty(\"formGroup\", ctx.consultaForm);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.iddocumentoSelected);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.getListDocumentos);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.idAnioSelected);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.getListAnio);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.idPeriodoSelected);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.getListPeriodo);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(15, _c0, ctx.getflag == true))(\"disabled\", true);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.getcontenido);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(29, 13, ctx.isLoading))(\"ngIfThen\", _r4)(\"ngIfElse\", _r6);\n      }\n    },\n    dependencies: [i8.NgClass, i8.NgForOf, i8.NgIf, i4.ɵNgNoValidate, i4.NgControlStatus, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.FormControlName, i9.MatInput, i10.MatFormField, i10.MatLabel, i11.MatSelect, i12.MatOption, i13.MatButton, i14.DefaultLayoutDirective, i15.DefaultClassDirective, i8.AsyncPipe],\n    styles: [\"html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{margin:0;height:100%;font-family:Roboto,Arial,sans-serif;color:#080808}my-app[_ngcontent-%COMP%]{display:block;height:100vh}.container[_ngcontent-%COMP%]{padding:24px;box-sizing:border-box;border-radius:25% 10%}.mat-checkbox-label[_ngcontent-%COMP%]{text-transform:capitalize}.example-container3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.spinner[_ngcontent-%COMP%]{position:absolute;margin:auto;inset:0;text-align:center;border:16px solid #f3f3f3;border-top:16px solid transparent;border-radius:50%;width:120px;height:120px;animation:_ngcontent-%COMP%_spin 2s linear infinite;transform:translate(-50%,-50%)}.overlay[_ngcontent-%COMP%]{position:fixed;display:block;width:100%;height:100%;top:0;left:0;background-color:#4a4a4acc;z-index:99999}.example-container4[_ngcontent-%COMP%]{width:40%;margin:3px}.example-container5[_ngcontent-%COMP%]{width:100%;margin:1px}.example-container[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;background-color:#f6f6f9b4;border-radius:20px}textarea[_ngcontent-%COMP%]{height:250px;background-color:#e4cf84;border-color:#e4cf84}.btn[_ngcontent-%COMP%]{width:80px;height:60px}.example-container2[_ngcontent-%COMP%]{width:80%;height:250%;background-color:#e4cf84;margin-top:10px;margin-bottom:10px;padding:12px;border-radius:10px}.new-row[_ngcontent-%COMP%]{background-color:#4216b9}.header-container2[_ngcontent-%COMP%]{width:25%}.body-container[_ngcontent-%COMP%]{display:flex;background-color:#f6f6f9b4}.mat-elevation-10[_ngcontent-%COMP%]{width:1200px;border-radius:21px 21px 21px 20px;-webkit-border-radius:21px 21px 21px 20px;-moz-border-radius:21px 21px 21px 20px;background-color:#e4cf84}p[_ngcontent-%COMP%]{background-color:#e4cf84}.example-spacer[_ngcontent-%COMP%]{flex:3 12 auto}.color[_ngcontent-%COMP%]{color:#34dd09;font-weight:700}.example-tabla[_ngcontent-%COMP%]{background-color:#7fffd4}table[_ngcontent-%COMP%]{background-color:#c9cbcb}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{background-color:#fcfdfc}.rectangulo[_ngcontent-%COMP%]{border-radius:10px}.example-full-width[_ngcontent-%COMP%]{width:100%;height:180px}.imagenlupa[_ngcontent-%COMP%]{width:80px;height:20px;margin:0 auto}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\"]\n  });\n  return ConsultasComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}